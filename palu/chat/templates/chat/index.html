{% extends "chat/inbox.html" %}

{% block chat_content %}

<!-- Header -->
<div class="p-4 border-b font-semibold bg-gray-100">
    {{ other_user.nama }}
</div>

<!-- Chat messages -->
<div id="chat-box" class="flex-1 p-4 overflow-y-auto space-y-3 bg-gray-50">
    {% for msg in messages %}
        {% if msg.sender.id == current_user.id %}
            <div class="flex justify-end">
                <div class="bg-(--color-primary) text-white px-4 py-2 rounded-xl max-w-xs shadow">
                    <p>{{ msg.message }}</p>
                    <p class="text-[10px] text-blue-200 mt-1 text-right">
                        {{ msg.created_at|date:"H:i" }}
                    </p>
                </div>
            </div>
        {% else %}
            <div class="flex justify-start">
                <div class="bg-white border px-4 py-2 rounded-xl max-w-xs shadow">
                    <p>{{ msg.message }}</p>
                    <p class="text-[10px] text-gray-400 mt-1">
                        {{ msg.created_at|date:"H:i" }}
                    </p>
                </div>
            </div>
        {% endif %}
    {% endfor %}
</div>

<!-- Input -->
<form method="POST" class="p-4 border-t flex gap-2 bg-white">
    {% csrf_token %}
    <input type="text" name="message" placeholder="Ketik pesan..."class="flex-1 border rounded-full px-4 py-2 bg-gray-100 focus:outline-none"required>
    <button class="bg-(--color-primary) text-white px-5 py-2 rounded-full">
        <i class="bi bi-send-fill"></i>
    </button>
</form>

<script>
    const chatBox = document.getElementById("chat-box");
    chatBox.scrollTop = chatBox.scrollHeight;
</script>

{% endblock %}